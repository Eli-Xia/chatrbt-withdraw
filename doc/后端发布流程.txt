1,test分支代码测试完成后,本地准备生产包.


2,连接冷备服务器

(1) ssh chatrbt@193.112.129.141


3,将生产环境当前项目压缩包拷贝到冷备服务器webapps目录下,启动项目.

(1) rm /home/chatrbt/tomcat/webapps/ROOT.zip

(2) scp chatrbt@172.16.0.14:/home/chatrbt/tomcat/webapps/ROOT.zip /home/chatrbt/tomcat/webapps/ROOT.zip

(3) deploy


4,连接生产环境服务器并将nginx指向冷备服务器,然后观察冷备服务器日志确保项目运行正常

(1) ssh chatrbt@123.207.125.230

(2) sudo cp -f /etc/nginx/nginx_bak.conf /etc/nginx/nginx.conf

(3) sudo nginx -s reload

(4) 冷备服务器下执行 deply debug


5,关闭生产服务器当前项目.

(1) deploy stop

(2) ps -ef|grep tomcat

(3) kill -9 pid


6,将本地准备好的即将发布的生产包上传至生产环境的webapps目录下,然后启动项目,将nginx指回生产服务器,观察日志确保项目正常运行.

(1) 使用客户端上传ROOT.zip

(2) deploy

(3) sudo cp -f /etc/nginx/nginx_pro.conf /etc/nginx/nginx.conf

(4) sudo nginx -s reload

(5) deploy debug


7,上产包发布后,关闭冷备服务器项目

(1) deploy stop

(2) ps -ef|grep tomcat

(3) kill -9 pid


8,生产项目测试无误后,将最近发布的代码合并并推送至master分支


9,在tower日历上记录发包信息